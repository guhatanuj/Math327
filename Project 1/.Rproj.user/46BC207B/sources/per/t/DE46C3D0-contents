---
title: "Equity and ACT in Colleges"
author: "Tanuj Guha"
date: "2023-03-07"
output: word_document
---

_Abstract_: In this project we are going to investigate the relationship between ACT scores, and several other factors that affect an individual's college admissions. The intention of this project is to estimate how much of the ACT scores of admitted students can be explained by other factors such as English Proficiency, Tutoring, High School GPA, among other things. 


```{r setup, warning = FALSE, message = FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Getting the data (appending legible names to dataset from dictionary)
```{r}
library(tidyverse)
library(readxl)
library(xlsx)
library(datadictionary)
data = read.csv("adm2021.csv")
dictData = read_xlsx("adm2021Dict.xlsx", sheet=2)
dict = data.frame(dictData$varname, dictData$varTitle)
names(data) <- dict$dictData.varTitle[match(names(data), dict$dictData.varname)]
#write.xlsx(data, file = "appendedData.xlsx", sheetName="Colleges")
```

Creating the final data set with only the chosen variables. 

```{r}
colleges = select(data,'Unique identification number of the institution')

colleges <- cbind(colleges,select(data,'ACT Composite 75th percentile score'),select(data,'Secondary school GPA'),select(data,'Completion of college-preparatory program'),select(data,'TOEFL (Test of English as a Foreign Language'),select(data,'Enrolled total'),select(data,'Percent of first-time degree/certificate-seeking students submitting ACT scores'),select(data,'SAT Evidence-Based Reading and Writing 75th percentile score'),select(data,'SAT Math 75th percentile score'))

colleges <- colleges %>% 
        rename("ID" = "Unique identification number of the institution",
               "ACT" = "ACT Composite 75th percentile score",
               "GPA" = "Secondary school GPA",
               "CollegePrep" = "Completion of college-preparatory program",
               "TOEFL" = "TOEFL (Test of English as a Foreign Language",
               "NumberEnrolled" = "Enrolled total",
               "ACTPercentage" = "Percent of first-time degree/certificate-seeking students submitting ACT scores",
               "SATWR" = "SAT Evidence-Based Reading and Writing 75th percentile score",
              "SATM"= "SAT Math 75th percentile score")

colleges = drop_na(colleges)
write.xlsx(colleges, file = "Colleges.xlsx", sheetName="Colleges")

```
This marks the end of house keeping data cleaning. 
 
 
```{r}
colleges = read_xlsx("colleges.xlsx")
```
